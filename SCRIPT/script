# The Snowpark package is required for Python Worksheets. 
# You can add more packages by selecting them using the Packages control and then importing them.

import snowflake.snowpark as snowpark
from snowflake.snowpark.functions import col

def main(session: snowpark.Session): 
    # Your code goes here, inside the "main" handler.
    tableName = 'information_schema.packages'
    dataframe = session.table(tableName).filter(col("language") == 'python')

    # Print a sample of the dataframe to standard output.
    dataframe.show()

    # Return value will appear in the Results tab.
    return dataframe


import random
status=['student','regular visitor','retiree']

def generate_values():
    return{
        'STATUSLABEL':random.choice(status)
    }

statuslabel=[generate_values()for _ in range (20)] 

def process_dataframe(session):
    df = session.create_dataframe(generate_values(), schema=["STATUSLABEL"])
    df.write.mode("append").save_as_table("STATUS", column_order="name")
    return df

